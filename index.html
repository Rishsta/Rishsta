<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rishsta | ุฑูุดุณุชุง</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="phone-frame">
        <div class="profile-container">
            <div class="profile-picture">
                <img src="photo_2025-11-10_16-46-23.jpg" alt="Rishsta Logo"> 
            </div>
            <h1>Rishsta</h1>
            <div class="description-text"><p>ุฃูุฑุงุญูู ุชุจุฏุฃ ูุน ุฑูุดุณุชุง</p></div>
            
            <div class="social-buttons-group">
                <a href="https://www.tiktok.com/@rishsta" target="_blank" class="social-button tiktok-btn">
                    <i class="fab fa-tiktok"></i><span>TikTok</span>
                </a>
                <a href="https://www.snapchat.com/add/RISHSTA-1" target="_blank" class="social-button snapchat-btn">
                    <i class="fab fa-snapchat-ghost"></i><span>Snapchat</span>
                </a>
                <a href="https://wa.me/966545998016" target="_blank" class="social-button whatsapp-btn whatsapp1">
                    <i class="fab fa-whatsapp"></i><span>ูุงุชุณุงุจ ุฑูุดุณุชุง ููุญุฌุฒ</span>
                </a>
            </div>

            <div class="extra-button-group">
                <a href="#" class="main-booking-button" onclick="openBookingModal()" style="margin-top: 15px;">
                    ๐ ุงุจุฏุฃ ุญุฌุฒ ุงูุจุงูุงุช ูุงูุฎุฏูุงุช ุงูุขู
                </a>
            </div>
        </div>
    </div>
    
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBookingModal()">ร</span>
            <h2>๐ ุจุฏุก ุญุฌุฒ ุงูุฎุฏูุงุช ูุน ุฑูุดุณุชุง</h2>
            
            <p style="color: red; font-weight: bold; margin-bottom: 15px;">*ููุงุญุธุฉ: ูุฐู ุงูุฃุณุนุงุฑ ุฎุงุตุฉ ุจุญููุงุช ุงูุฃุนุฑุงุณ ูุงูููุงุณุจุงุช ุงููุจุฑู.*</p>
            <p style="font-size: 0.9em; margin-bottom: 20px; padding: 10px; border: 1px dashed #ff9900;">ูุฏุฉ ุชูุงุฌุฏ ุงูููุงุฏุฑ ูู **6 ุณุงุนุงุช**ุ ูุซุงู: ูุจุฏุฃ ุงูุชูุงุฌุฏ 5:30 ูุณุงุกู ูููุชูู 11:30 ูุณุงุกู.</p>
            
            <p>ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุจูุงูุงุช ุงูุญุฌุฒ ุงูุฃุณุงุณูุฉ:</p>

            <form id="bookingForm">
                <label for="clientName">ุงูุงุณู ุงููุงูู:</label>
                <input type="text" id="clientName" required>

                <label for="clientPhone">ุฑูู ุงูุฌูุงู:</label>
                <input type="tel" id="clientPhone" placeholder="05xxxxxxxx" required>

                <input type="hidden" id="emailInput" value="s202341370@kfupm.edu.sa">

                <label for="eventType">ููุน ุงูููุงุณุจุฉ:</label>
                <input type="text" id="eventType" required>

                <label>ูููุน ุฅูุงูุฉ ุงูููุงุณุจุฉ:</label>
                <div class="location-box">
                    <button type="button" class="map-btn" onclick="openGoogleMapApp()">
                        ๐ ุงุถุบุท ููุชุญ ุงูุฎุฑูุทุฉ ููุณุฎ ุงูุฑุงุจุท
                    </button>
                    <p style="font-size: 0.8em; color: #666; margin: 5px 0;">(ุจุนุฏ ูุชุญ ุงูุฎุฑูุทุฉุ ุญุฏุฏ ูููุนูุ ุงุถุบุท ูุดุงุฑูุฉุ ุงูุณุฎ ุงูุฑุงุจุทุ ุซู ุงูุตูู ุจุงูุฃุณูู)</p>
                    
                    <input type="text" id="eventLocationName" placeholder="ุงุณู ุงููุงุนุฉ / ุงูุงุณุชุฑุงุญุฉ" required style="margin-top: 5px;">
                    <input type="url" id="eventLocationLink" placeholder="ูุตู ุฑุงุจุท ุงููููุน ููุง (Google Map Link)" required>
                </div>

                <label for="eventDate">ุงูุชุงุฑูุฎ ุงููุทููุจ:</label>
                <input type="date" id="eventDate" required>
                
                <button type="button" class="check-btn" onclick="checkDateAvailability()">ุชุญูู ูู ุงูุชูุงูุฑ</button>
                <p id="availabilityStatus" style="font-weight: bold; margin-top: 10px;"></p>

                <hr>
                
                <h3 style="margin-top: 20px;">ุงุฎุชุฑ ุงูุฎุฏูุงุช ุงููุทููุจุฉ (ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ุฎุฏูุฉ):</h3>
                
                <div class="main-services">
                    <input type="checkbox" id="service1" name="service" value="ุถูุงูุฉ ุฑูุดุณุชุง" onchange="updateBookingOptions()">
                    <label for="service1">โจ ุถูุงูุฉ ุฑูุดุณุชุง </label>
                </div>

                <div class="main-services">
                    <input type="checkbox" id="service2" name="service" value="ุจูููู ูููุน" onchange="updateBookingOptions()">
                    <label for="service2">๐ฝ๏ธ ุจูููู ุฑูุดุณุชุง ุงููุชูุงูู</label>
                </div>

                <div class="main-services">
                    <input type="checkbox" id="service3" name="service" value="ุชุฑุชูุจ ุตูุงูู ุงูุนุดุงุก" onchange="updateBookingOptions()">
                    <label for="service3">๐ด ุชุฑุชูุจ ุตูุงูู ุงูุนุดุงุก</label>
                </div>
                
                <div id="additionalOptions"></div>
                
                <hr>
                
                <h3 style="margin-top: 20px;">ููุฎุต ูุชุฃููุฏ ุงูุญุฌุฒ:</h3>
                <p>ุงูุฅุฌูุงูู ุงูุชูุฏูุฑู: <span id="totalPrice" style="color: #ff9900; font-size: 1.5em; font-weight: bold;">0</span> ุฑ.ุณ</p>
                
                <button type="button" class="submit-btn" onclick="confirmBooking()">
                    ุฅุฑุณุงู ุงูุทูุจ ูุงูุชูุงุตูู ุนุจุฑ ุงููุงุชุณุงุจ
                </button>
                
                <div style="margin-top: 20px; padding: 10px; border: 1px dashed #ccc;">
                    <h4>ุฎุฏูุงุช ุฅุถุงููุฉ:</h4>
                    <p>ุฅุฐุง ูุงูุช ูุฏูู ุฎุฏูุฉ ุฃุฎุฑู ุบูุฑ ููุฌูุฏุฉุ ูุฑุฌู ูุชุงุจุชูุง ูู ุฑุณุงูุฉ ุงููุงุชุณุงุจ ุฃู ุงูุชูุงุตู ูุนูุง. <span style="font-weight: bold;">ููุณุนุฏ ุจุฎุฏูุชูู ๐ฟ</span></p>
                </div>
            </form>
        </div>
    </div>

    <script>
        const bookingModal = document.getElementById('bookingModal');
        const totalElement = document.getElementById('totalPrice');
        const additionalOptionsDiv = document.getElementById('additionalOptions');
        const WEBHOOK_URL = 'https://hook.us2.make.com/2sbytwqqg9mqm0dy1jjdltumrer3t5ki';
        const HIDDEN_ADMIN_EMAIL = 's202341370@kfupm.edu.sa';

        const PRICES = {
            service2Base: 3700, service3Base: 1200, 
            extraWater: 11, extraBaklava: 150, extraDatesSweet: 120,
            extraStaff: 150, extraBuffet100: 500, extraFruit: 200, 
        };

        function openBookingModal() {
            bookingModal.style.display = 'block';
            document.body.style.overflow = 'hidden'; 
            updateBookingOptions();
        }

        function closeBookingModal() {
            bookingModal.style.display = 'none';
            document.body.style.overflow = 'auto'; 
        }

        window.onclick = function(event) {
            if (event.target == bookingModal) closeBookingModal();
        }
        
        // ูุธููุฉ ุฌุฏูุฏุฉ ููุชุญ ุชุทุจูู ุงูุฎุฑุงุฆุท
        function openGoogleMapApp() {
            // ูุญุงูู ูุชุญ ุงูุชุทุจูู ุนูู ุงููููุน ุงูุญุงูู ูููุณุชุฎุฏู ุฃู ููุชุญ ุตูุญุฉ ุฌูุฌู ูุงุจ ุงูุนุงูุฉ
            window.open("https://www.google.com/maps", "_blank");
        }

        // ุชู ุชุญุฏูุซ ูุฐู ุงูุฏุงูุฉ ูุชูุฑุฃ ุงูุฑุงุจุท ุงูุฐู ูุถุนู ุงูุนููู
        function getMapLink() {
            return document.getElementById('eventLocationLink').value;
        }

        function updateBookingOptions() {
            let optionsHtml = '';
            if (document.getElementById('service1').checked) {
                optionsHtml += `
                    <fieldset style="border: 1px solid #ff9900; padding: 10px; margin-top: 15px;">
                        <legend>โจ ุถูุงูุฉ ุฑูุดุณุชุง (ุงุฎุชูุงุฑ ุฅุฌุจุงุฑู ููุจุงูุฉ)</legend>
                        <div style="text-align: right; margin-bottom: 20px;">
                            <input type="radio" id="p1" name="pkg1" value="ุงูุจุงูุฉ ุงูุนุงุฏูุฉ" data-price="800" data-staff="3" onchange="calculateTotal()" required>
                            <label for="p1" style="font-weight: bold;">ุงูุจุงูุฉ ุงูุนุงุฏูุฉ (800 ุฑ.ุณ)</label>
                            <ul style="margin-top: 5px; font-size: 0.9em; color: #555; margin-bottom: 10px;"><li>โ ูููุฉ ุนุฑุจูุฉุ ุดุงูุ ูุนูุงุน | ๐ด ุชูุฑ + ุทุญูููุฉ</li><li>๐ฅ 3 ููุงุฏุฑ | ๐ฅ ุงููุญู ุนูููุง ูุงูุนูุฏ ุนููู</li></ul>
                            <input type="radio" id="p2" name="pkg1" value="ุงูุจุงูุฉ ุงููุชูุณุทุฉ" data-price="1000" data-staff="4" onchange="calculateTotal()" required>
                            <label for="p2" style="font-weight: bold;">ุงูุจุงูุฉ ุงููุชูุณุทุฉ (1000 ุฑ.ุณ)</label>
                            <ul style="margin-top: 5px; font-size: 0.9em; color: #555; margin-bottom: 10px;"><li>โ ุดุงู ูุงุฎุฑุ ูููุฉุ ููููู ุฃุณูุฏุ ูุฑูุฏูู </li><li>๐ด ุชูุฑ ุนุงุฏูุ ุชูุฑ ุจุงูุณูุณูุ ุทุญูููุฉ | ๐ฅ 4 ููุงุฏุฑ | ๐ฅ ุงููุญู ูุงูุนูุฏ ุนูููุง</li></ul>
                            <input type="radio" id="p3" name="pkg1" value="ุงูุจุงูุฉ ุงููุฎูุฉ" data-price="1200" data-staff="5" onchange="calculateTotal()" required>
                            <label for="p3" style="font-weight: bold;">ุงูุจุงูุฉ ุงููุฎูุฉ (1200 ุฑ.ุณ)</label>
                            <ul style="margin-top: 5px; font-size: 0.9em; color: #555; margin-bottom: 10px;"><li>โ ุฌููุน ูุง ุณุจู + ููุช ุดููููุช ููุงุณุชุฑ</li><li>๐ด ุชูุฑ ูุญุดูุ ุชูุฑ ุจุงูุณูุณู ูุงูุญููุฉุ ุทุญูููุฉ | ๐ฅ 5 ููุงุฏุฑ | ๐ฅ ุงููุญู ูุงูุนูุฏ ุนูููุง</li></ul>
                        </div>
                        <hr>
                        <legend>โ ุฎุฏูุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู):</legend>
                        <div style="margin-top: 10px;">
                            <label style="font-weight: bold;">๐ง ูุฑุงุชูู ูุงุก (+${PRICES.extraWater} ุฑ.ุณ ูููุฑุชูู):</label>
                            <input type="number" id="extraWater1" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎู ุงููููุฉ)</span><br>
                            <label style="font-weight: bold; margin-top: 10px;">๐ซ ุตุญูู ุจููุงูุฉ (+${PRICES.extraBaklava} ุฑ.ุณ ูู 3 ุตุญูู):</label>
                            <input type="number" id="extraBaklava1" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎูย ุงููููุฉ)</span><br>
                            <label style="font-weight: bold; margin-top: 10px;">๐ด ุญูู ุงูุชูุฑ (+${PRICES.extraDatesSweet} ุฑ.ุณ ูู 3 ุตุญูู):</label>
                            <input type="number" id="extraDatesSweet1" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎูย ุงููููุฉ)</span><br>
                            <label style="font-weight: bold; margin-top: 10px;">๐ฅ ุฅุถุงูุฉ ููุงุฏุฑ (+${PRICES.extraStaff} ุฑ.ุณ ูููุงุฏุฑ):</label>
                            <input type="number" id="extraStaff1" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎู ุนุฏุฏ ุงูููุงุฏุฑ ุงูุฅุถุงููุฉ)</span>
                        </div>
                    </fieldset>`;
            }
            if (document.getElementById('service2').checked) {
                optionsHtml += `
                    <fieldset style="border: 1px solid #25D366; padding: 10px; margin-top: 15px;">
                        <legend>๐ฝ๏ธ ุจูููู ุฑูุดุณุชุง (ุงูุณุนุฑ ุงูุฃุณุงุณู ${PRICES.service2Base} ุฑ.ุณ ูู 300 ุดุฎุต)</legend>
                        <ul style="font-size: 0.9em; color: #555; text-align: right; margin-top: 5px;"><li>ุชุดูู ุงูุฎุฏูุฉ: 3 ุฃุตูุงู ุฑุฆูุณูุฉุ ูุนุฌูุงุชุ ููุจูุฉุ ุณูุจูุณุฉุ ูููุ ููุงูุฉุ ุจููุงูุฉุ ููุณุฑุงุชุ ูุฑู ุนูุจุ ุฐุฑุฉุ ุจูููุฉุ ููููุชูุ ุนุตูุฑ ูุงูุฌู ุงู ุจุฑุชูุงู.</li><li>๐ฅ ุงูุทุงูู: 3 ููุงุฏุฑ ุณุนูุฏููู ุจุฒู ููุญุฏ.</li></ul>
                        <div style="text-align: right; margin-bottom: 10px; border-top: 1px dashed #ccc; padding-top: 10px;">
                            <label style="font-weight: bold;">๐ฅ ุฒูุงุฏุฉ ุนุฏุฏ ุงูุฃุดุฎุงุต (ูู 100 ุดุฎุต ุฅุถุงูู):</label>
                            <input type="number" id="extraGuests2" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุชูููุฉ ูู 100 ุดุฎุต ูู +${PRICES.extraBuffet100} ุฑ.ุณ)</span>
                        </div>
                        <legend>โ ุฎุฏูุงุช ุงูุจูููู ุงูุฅุถุงููุฉ (ุงุฎุชูุงุฑู):</legend>
                        <div style="margin-top: 10px;">
                            <label style="font-weight: bold;">๐ง ูุฑุงุชูู ูุงุก (+${PRICES.extraWater} ุฑ.ุณ ูููุฑุชูู):</label>
                            <input type="number" id="extraWater2" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎู ุงููููุฉ)</span><br>
                            <label style="font-weight: bold; margin-top: 10px;">๐ ุณูุฉ ููุงูู ุทุงุฒุฌุฉ (+${PRICES.extraFruit} ุฑ.ุณ):</label>
                            <input type="number" id="extraFruit2" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎูย ุงููููุฉ ุงููุทููุจุฉ)</span><br>
                            <label style="font-weight: bold; margin-top: 10px;">๐ฅ ุฅุถุงูุฉ ููุงุฏุฑ (+${PRICES.extraStaff} ุฑ.ุณ ูููุงุฏุฑ):</label>
                            <input type="number" id="extraStaff2" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ุฃุฏุฎู ุนุฏุฏ ุงูููุงุฏุฑ)</span>
                        </div>
                    </fieldset>`;
            }
            if (document.getElementById('service3').checked) {
                optionsHtml += `
                    <fieldset style="border: 1px solid #555; padding: 10px; margin-top: 15px;">
                        <legend>๐ด ุชุฑุชูุจ ุตูุงูู ุงูุนุดุงุก (ุงูุณุนุฑ ุงูุฃุณุงุณู ${PRICES.service3Base} ุฑ.ุณ ูู 7 ููุงุฏุฑ)</legend>
                        <ul style="font-size: 0.9em; color: #555; text-align: right; margin-top: 5px;"><li>ุชุดูู ุงูุฎุฏูุฉ: 7 ููุงุฏุฑ ูุชุฑุชูุจ ูุชูุฏูู ุงูุตูุงูู ุญุณุจ ุงูุฏูุนุงุช ุงููุทููุจุฉ.</li></ul>
                        <div style="border-top: 1px dashed #ccc; padding-top: 10px;">
                            <label style="font-weight: bold;">ูู ุฏูุนุฉ (ุนุฏุฏ ุงููุฑุงุช)ุ</label>
                            <input type="number" id="numTrays3" min="1" value="1" onchange="calculateTotal()"><br>
                            <label style="font-weight: bold; margin-top: 10px;">ูู ุตูููุฉ ูุฏููุ</label>
                            <input type="number" id="numPlates3" min="1" value="1" onchange="calculateTotal()"><br>
                            <label style="font-weight: bold; margin-top: 10px;">ูุชู ุชุฑูุฏูุง ุฃู ูุจุฏุฃ (ููุช ุงููุชุญ)ุ</label>
                            <input type="time" id="startTime3" onchange="calculateTotal()"><br>
                            <label style="font-weight: bold; margin-top: 10px;">ูู ุงููุฏุฉ ุจูู ูู ุฏูุนุฉุ</label>
                            <input type="number" id="duration3" min="10" value="30" onchange="calculateTotal()">
                        </div>
                        <legend>โ ุฎูุงุฑุงุช ุฅุถุงููุฉ:</legend>
                        <div style="margin-top: 10px;">
                            <input type="checkbox" id="genderSplit3" onchange="calculateTotal()">
                            <label for="genderSplit3">ููุฌุฏ ูุณู ุฑุฌุงู ููุณุงุก ุ</label><br>
                            <label style="font-weight: bold; margin-top: 10px;">ูู ุนุฏุฏ ุงููุฑุงุณู ููู ุตูููุฉุ</label>
                            <input type="number" id="numChairs3" min="0" value="0" onchange="calculateTotal()"><span style="font-size: 0.9em;"> (ูุชูุธูู ุงููุงุนุฉ)</span><br>
                            <label style="font-weight: bold; margin-top: 10px;">๐ฅ ุฅุถุงูุฉ ููุงุฏุฑ (+${PRICES.extraStaff} ุฑ.ุณ ูููุงุฏุฑ):</label>
                            <input type="number" id="extraStaff3" min="0" value="0" onchange="calculateTotal()">
                        </div>
                    </fieldset>`;
            }
            additionalOptionsDiv.innerHTML = optionsHtml;
            calculateTotal();
        }

        function calculateTotal() {
            let currentTotal = 0;
            let details = [];

            if (document.getElementById('service1').checked) {
                const selectedPackage = document.querySelector('input[name="pkg1"]:checked');
                let pkgPrice = 0;
                if (selectedPackage) {
                    pkgPrice = parseFloat(selectedPackage.dataset.price);
                    currentTotal += pkgPrice;
                    details.push(`ุถูุงูุฉ: ${selectedPackage.value} - ${pkgPrice} ุฑ.ุณ`);
                }
                const waterQty = parseInt(document.getElementById('extraWater1')?.value || 0);
                if(waterQty > 0) { currentTotal += waterQty * PRICES.extraWater; details.push(`+ ${waterQty} ูุงุก (ุถูุงูุฉ)`); }
                
                const baklavaQty = parseInt(document.getElementById('extraBaklava1')?.value || 0);
                if(baklavaQty > 0) { currentTotal += baklavaQty * PRICES.extraBaklava; details.push(`+ ${baklavaQty} ุจููุงูุฉ`); }
                
                const datesQty = parseInt(document.getElementById('extraDatesSweet1')?.value || 0);
                if(datesQty > 0) { currentTotal += datesQty * PRICES.extraDatesSweet; details.push(`+ ${datesQty} ุญูู ุชูุฑ`); }
                
                const extraStaffQty = parseInt(document.getElementById('extraStaff1')?.value || 0);
                if(extraStaffQty > 0) { currentTotal += extraStaffQty * PRICES.extraStaff; details.push(`+ ${extraStaffQty} ูุงุฏุฑ (ุถูุงูุฉ)`); }
            }
            
            if (document.getElementById('service2').checked) {
                currentTotal += PRICES.service2Base;
                details.push(`ุจูููู: ุงูุณุนุฑ ุงูุฃุณุงุณู (300 ุดุฎุต) - ${PRICES.service2Base} ุฑ.ุณ`);
                const extraGuestsQty = parseInt(document.getElementById('extraGuests2')?.value || 0);
                if(extraGuestsQty > 0) { 
                    currentTotal += extraGuestsQty * PRICES.extraBuffet100;
                    details.push(`+ ${extraGuestsQty * 100} ุดุฎุต ุฅุถุงูู`); 
                }
                const waterQty = parseInt(document.getElementById('extraWater2')?.value || 0);
                if(waterQty > 0) { currentTotal += waterQty * PRICES.extraWater; details.push(`+ ${waterQty} ูุงุก (ุจูููู)`); }
                
                const fruitQty = parseInt(document.getElementById('extraFruit2')?.value || 0);
                if(fruitQty > 0) { currentTotal += fruitQty * PRICES.extraFruit; details.push(`+ ${fruitQty} ููุงูู`); }

                const extraStaffQty = parseInt(document.getElementById('extraStaff2')?.value || 0);
                if(extraStaffQty > 0) { currentTotal += extraStaffQty * PRICES.extraStaff; details.push(`+ ${extraStaffQty} ูุงุฏุฑ (ุจูููู)`); }
            }
            
            if (document.getElementById('service3').checked) {
                currentTotal += PRICES.service3Base;
                details.push(`ุชุฑุชูุจ ุงูุตูุงูู: (7 ููุงุฏุฑ) - ${PRICES.service3Base} ุฑ.ุณ`);
                details.push(`(ุฏูุนุงุช: ${document.getElementById('numTrays3')?.value || '-'}, ุตูุงูู: ${document.getElementById('numPlates3')?.value || '-'})`);

                const extraStaffQty = parseInt(document.getElementById('extraStaff3')?.value || 0);
                if(extraStaffQty > 0) { currentTotal += extraStaffQty * PRICES.extraStaff; details.push(`+ ${extraStaffQty} ูุงุฏุฑ (ุตูุงูู)`); }
            }

            totalElement.textContent = currentTotal.toLocaleString();
            return { total: currentTotal, details: details };
        }

        function collectDataForWebhook() {
            const calculatedData = calculateTotal();
            const selectedServices = [];
            if (document.getElementById('service1').checked) selectedServices.push(document.getElementById('service1').value);
            if (document.getElementById('service2').checked) selectedServices.push(document.getElementById('service2').value);
            if (document.getElementById('service3').checked) selectedServices.push(document.getElementById('service3').value);

            return {
                clientName: document.getElementById('clientName').value,
                clientPhone: document.getElementById('clientPhone').value,
                adminEmail: HIDDEN_ADMIN_EMAIL, 
                eventDate: document.getElementById('eventDate').value,
                eventType: document.getElementById('eventType').value,
                eventLocation: document.getElementById('eventLocationName').value, // ุงูุงุณู ููุท
                totalPrice: calculatedData.total,
                finalPriceText: totalElement.textContent + ' ุฑ.ุณ',
                mapLink: document.getElementById('eventLocationLink').value, // ุงูุฑุงุจุท ููุท
                selectedServices: selectedServices.join(', '),
                detailedBreakdown: calculatedData.details.join('\n- ')
            };
        }

        async function sendToNotion(data) {
            try {
                await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
            } catch (error) { console.error('Error sending data:', error); }
        }

        async function confirmBooking() {
            const clientName = document.getElementById('clientName').value;
            const clientPhone = document.getElementById('clientPhone').value;
            const eventDate = document.getElementById('eventDate').value;
            const eventType = document.getElementById('eventType').value;
            const eventLocationName = document.getElementById('eventLocationName').value;
            const eventLocationLink = document.getElementById('eventLocationLink').value;

            if (!clientName || !clientPhone || !eventDate || !eventType || !eventLocationName || !eventLocationLink) {
                alert('ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุฌููุน ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ูุฑุงุจุท ุงููููุน.');
                return;
            }
            
            const isService1Checked = document.getElementById('service1').checked;
            if (isService1Checked && !document.querySelector('input[name="pkg1"]:checked')) {
                 alert('ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุจุงูุฉ ุงูุถูุงูุฉ (ุงูุนุงุฏูุฉุ ุงููุชูุณุทุฉุ ุฃู ุงููุฎูุฉ) ูุงุณุชููุงู ุงูุญุฌุฒ.');
                 return;
            }

            if (isService1Checked) {
                const baklavaQty = parseInt(document.getElementById('extraBaklava1')?.value || 0);
                const datesQty = parseInt(document.getElementById('extraDatesSweet1')?.value || 0);
                if (baklavaQty === 0 && datesQty === 0) {
                    const confirmUpsell = confirm("โจ ูุชุฃูุฏ ูุง ุชุจู ุชุชุฌูู ูุน ูุนุงุฒููู ุฃูุซุฑ ูุชุฌูุจ ููู ุญููุ\nุงุถุบุท 'ุฅูุบุงุก' ูุฅุถุงูุฉ ุงูุญูู.");
                    if (!confirmUpsell) return; 
                }
            }
            
            const bookingData = collectDataForWebhook();
            sendToNotion(bookingData); 
            
            let whatsappMessage = `*๐ ุทูุจ ุญุฌุฒ ุฌุฏูุฏ - ุฑูุดุณุชุง ๐*\n\n`;
            whatsappMessage += `*ุงูุนููู:* ${bookingData.clientName}\n*ุงูุฌูุงู:* ${bookingData.clientPhone}\n*ุงูุชุงุฑูุฎ:* ${bookingData.eventDate}\n*ุงูููุงุณุจุฉ:* ${bookingData.eventType}\n`;
            whatsappMessage += `*ุงููููุน:* ${bookingData.eventLocation}\n`;
            if (bookingData.mapLink) whatsappMessage += `*ุฑุงุจุท ุงูุฎุฑูุทุฉ:* ${bookingData.mapLink}\n\n`;
            whatsappMessage += `*๐ ุงูุฎุฏูุงุช ุงููุฎุชุงุฑุฉ:*\n- ${bookingData.detailedBreakdown}\n\n`;
            whatsappMessage += `*๐ฐ ุงูุฅุฌูุงูู ุงูุชูุฏูุฑู:* ${bookingData.finalPriceText}`;

            const whatsappNumber = '966544512811';
            const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;
            
            alert(`ุดูุฑุงู ูู ูุง ${clientName}!\n\nุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ.\nุณูุชู ุชุญูููู ุฅูู ุงููุงุชุณุงุจ ุงูุขู ูุฅุฑุณุงู ุงูุชูุงุตูู ูุงุนุชูุงุฏ ุงูุญุฌุฒ.`);
            window.open(whatsappURL, '_blank');
            closeBookingModal();
        }

        function checkDateAvailability() {
            const dateInput = document.getElementById('eventDate').value;
            const statusElement = document.getElementById('availabilityStatus');
            if (!dateInput) {
                statusElement.textContent = "ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุชุงุฑูุฎ ุฃููุงู.";
                statusElement.style.color = 'red';
                return;
            }
            statusElement.textContent = "โ ุงูุชุงุฑูุฎ ูุชุงุญ ูุจุฏุฆูุงู.";
            statusElement.style.color = 'green';
        }

        document.addEventListener('DOMContentLoaded', () => {
            const formElements = document.getElementById('bookingForm').elements;
            for (let i = 0; i < formElements.length; i++) {
                formElements[i].addEventListener('change', updateBookingOptions);
                formElements[i].addEventListener('input', updateBookingOptions);
            }
            updateBookingOptions();
        });
    </script>
</body>
</html>
