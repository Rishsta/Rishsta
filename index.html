<script>
        // **********************************
        // 1. ุงููุชุบูุฑุงุช ูุงูุฃุณุนุงุฑ ุงูุฃุณุงุณูุฉ
        // **********************************
        const bookingModal = document.getElementById('bookingModal');
        const totalElement = document.getElementById('totalPrice');
        const additionalOptionsDiv = document.getElementById('additionalOptions');
        
        // ุฑุงุจุท Make.com ุงูุฎุงุต ุจู
        const WEBHOOK_URL = 'https://hook.us2.make.com/2sbytwqqg9mqm0dy1jjdltumrer3t5ki';

        const PRICES = {
            service2Base: 3700, 
            service3Base: 1200, 
            
            extraWater: 11, 
            extraBaklava: 150,
            extraDatesSweet: 120,
            extraStaff: 150,
            extraBuffet100: 500,
            extraFruit: 200, 
        };

        // **********************************
        // 2. ูุธุงุฆู ูุชุญ ูุฅุบูุงู ุงููุงูุฐุฉ
        // **********************************
        function openBookingModal() {
            bookingModal.style.display = 'block';
            document.body.style.overflow = 'hidden'; 
            updateBookingOptions();
        }

        function closeBookingModal() {
            bookingModal.style.display = 'none';
            document.body.style.overflow = 'auto'; 
        }

        window.onclick = function(event) {
            if (event.target == bookingModal) {
                closeBookingModal();
            }
        }
        
        // **********************************
        // 3. ูุธููุฉ ุฅูุดุงุก ุฑุงุจุท ุงูุฎุฑูุทุฉ (Google Maps)
        // **********************************
        function getMapLink() {
            const location = document.getElementById('eventLocation').value;
            if (!location) {
                return null;
            }
            // ุจูุงุก ุฑุงุจุท Google Maps ููุชุญ ุงูุฎุฑูุทุฉ ูุจุงุดุฑุฉ ุจูุงุกู ุนูู ุงุณู ุงููููุน
            return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`;
        }


        // **********************************
        // 4. ูุธููุฉ ุนุฑุถ ุงูุฎูุงุฑุงุช ุงูุฅุถุงููุฉ
        // **********************************
        function updateBookingOptions() {
            let optionsHtml = '';

            // --- ุถูุงูุฉ ุฑูุดุณุชุง ุงูุฃูููุฉ ---
            if (document.getElementById('service1').checked) {
                optionsHtml += `
                    <fieldset style="border: 1px solid #ff9900; padding: 10px; margin-top: 15px;">
                        <legend>โจ ุถูุงูุฉ ุฑูุดุณุชุง (ุงุฎุชูุงุฑ ุฅุฌุจุงุฑู ููุจุงูุฉ)</legend>
                        <div style="text-align: right; margin-bottom: 20px;">
                            
                            <input type="radio" id="p1" name="pkg1" value="ุงูุจุงูุฉ ุงูุนุงุฏูุฉ" data-price="800" data-staff="3" onchange="calculateTotal()" required>
                            <label for="p1" style="font-weight: bold;">ุงูุจุงูุฉ ุงูุนุงุฏูุฉ (800 ุฑ.ุณ)</label>
                            <ul style="margin-top: 5px; font-size: 0.9em; color: #555; margin-bottom: 10px;">
                                <li>โ ูููุฉ ุนุฑุจูุฉุ ุดุงูุ ูุนูุงุน | ๐ด ุชูุฑ + ุทุญูููุฉ</li>
                                <li>๐ฅ 3 ููุงุฏุฑ | ๐ฅ ุงููุญู ุนูููุง ูุงูุนูุฏ ุนููู</li>
                            </ul>

                            <input type="radio" id="p2" name="pkg1" value="ุงูุจุงูุฉ ุงููุชูุณุทุฉ" data-price="1000" data-staff="4" onchange="calculateTotal()" required>
                            <label for="p2" style="font-weight: bold;">ุงูุจุงูุฉ ุงููุชูุณุทุฉ (1000 ุฑ.ุณ)</label>
                            <ul style="margin-top: 5px; font-size: 0.9em; color: #555; margin-bottom: 10px;">
                                <li>โ ุดุงู ูุงุฎุฑุ ูููุฉุ ููููู ุฃุณูุฏุ ูุฑูุฏูู </li>
                                <li>๐ด ุชูุฑ ุนุงุฏูุ ุชูุฑ ุจุงูุณูุณูุ ุทุญูููุฉ | ๐ฅ 4 ููุงุฏุฑ | ๐ฅ ุงููุญู ูุงูุนูุฏ ุนูููุง</li>
                            </ul>
                            
                            <input type="radio" id="p3" name="pkg1" value="ุงูุจุงูุฉ ุงููุฎูุฉ" data-price="1200" data-staff="5" onchange="calculateTotal()" required>
                            <label for="p3" style="font-weight: bold;">ุงูุจุงูุฉ ุงููุฎูุฉ (1200 ุฑ.ุณ)</label>
                            <ul style="margin-top: 5px; font-size: 0.9em; color: #555; margin-bottom: 10px;">
                                <li>โ ุฌููุน ูุง ุณุจู + ููุช ุดููููุช ููุงุณุชุฑ</li>
                                <li>๐ด ุชูุฑ ูุญุดูุ ุชูุฑ ุจุงูุณูุณู ูุงูุญููุฉุ ุทุญูููุฉ | ๐ฅ 5 ููุงุฏุฑ | ๐ฅ ุงููุญู ูุงูุนูุฏ ุนูููุง</li>
                            </ul>
                        </div>

                        <hr>
                        
                        <legend>โ ุฎุฏูุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู):</legend>
                        <div style="margin-top: 10px;">
                            <label style="font-weight: bold;">๐ง ูุฑุงุชูู ูุงุก (+${PRICES.extraWater} ุฑ.ุณ ูููุฑุชูู):</label>
                            <input type="number" id="extraWater1" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎู ุงููููุฉ)</span><br>

                            <label style="font-weight: bold; margin-top: 10px;">๐ซ ุตุญูู ุจููุงูุฉ (+${PRICES.extraBaklava} ุฑ.ุณ ูู 3 ุตุญูู):</label>
                            <input type="number" id="extraBaklava1" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎูย ุงููููุฉ)</span><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">๐ด ุญูู ุงูุชูุฑ (+${PRICES.extraDatesSweet} ุฑ.ุณ ูู 3 ุตุญูู):</label>
                            <input type="number" id="extraDatesSweet1" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎูย ุงููููุฉ)</span><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">๐ฅ ุฅุถุงูุฉ ููุงุฏุฑ (+${PRICES.extraStaff} ุฑ.ุณ ูููุงุฏุฑ):</label>
                            <input type="number" id="extraStaff1" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎู ุนุฏุฏ ุงูููุงุฏุฑ ุงูุฅุถุงููุฉ)</span>
                        </div>
                    </fieldset>`;
            }

            // --- ุจูููู ุฑูุดุณุชุง ุงููุชูุงูู ---
            if (document.getElementById('service2').checked) {
                optionsHtml += `
                    <fieldset style="border: 1px solid #25D366; padding: 10px; margin-top: 15px;">
                        <legend>๐ฝ๏ธ ุจูููู ุฑูุดุณุชุง (ุงูุณุนุฑ ุงูุฃุณุงุณู ${PRICES.service2Base} ุฑ.ุณ ูู 300 ุดุฎุต)</legend>
                        <ul style="font-size: 0.9em; color: #555; text-align: right; margin-top: 5px;">
                            <li>ุชุดูู ุงูุฎุฏูุฉ: 3 ุฃุตูุงู ุฑุฆูุณูุฉุ ูุนุฌูุงุชุ ููุจูุฉุ ุณูุจูุณุฉุ ูููุ ููุงูุฉุ ุจููุงูุฉุ ููุณุฑุงุชุ ูุฑู ุนูุจุ ุฐุฑุฉุ ุจูููุฉุ ููููุชูุ ุนุตูุฑ ูุงูุฌู ุงู ุจุฑุชูุงู.</li>
                            <li>๐ฅ ุงูุทุงูู: 3 ููุงุฏุฑ ุณุนูุฏููู ุจุฒู ููุญุฏ.</li>
                        </ul>
                        
                        <div style="text-align: right; margin-bottom: 10px; border-top: 1px dashed #ccc; padding-top: 10px;">
                            <label style="font-weight: bold;">๐ฅ ุฒูุงุฏุฉ ุนุฏุฏ ุงูุฃุดุฎุงุต (ูู 100 ุดุฎุต ุฅุถุงูู):</label>
                            <input type="number" id="extraGuests2" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุชูููุฉ ูู 100 ุดุฎุต ูู +${PRICES.extraBuffet100} ุฑ.ุณ)</span>
                        </div>
                        
                        <legend>โ ุฎุฏูุงุช ุงูุจูููู ุงูุฅุถุงููุฉ (ุงุฎุชูุงุฑู):</legend>
                        <div style="margin-top: 10px;">
                            <label style="font-weight: bold;">๐ง ูุฑุงุชูู ูุงุก (+${PRICES.extraWater} ุฑ.ุณ ูููุฑุชูู):</label>
                            <input type="number" id="extraWater2" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎู ุงููููุฉ)</span><br>

                            <label style="font-weight: bold; margin-top: 10px;">๐ ุณูุฉ ููุงูู ุทุงุฒุฌุฉ (+${PRICES.extraFruit} ุฑ.ุณ):</label>
                            <input type="number" id="extraFruit2" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎูย ุงููููุฉ ุงููุทููุจุฉ)</span><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">๐ฅ ุฅุถุงูุฉ ููุงุฏุฑ (+${PRICES.extraStaff} ุฑ.ุณ ูููุงุฏุฑ):</label>
                            <input type="number" id="extraStaff2" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ุฃุฏุฎู ุนุฏุฏ ุงูููุงุฏุฑ)</span>
                        </div>
                    </fieldset>`;
            }

            // --- ุชุฑุชูุจ ุตูุงูู ุงูุนุดุงุก ---
            if (document.getElementById('service3').checked) {
                optionsHtml += `
                    <fieldset style="border: 1px solid #555; padding: 10px; margin-top: 15px;">
                        <legend>๐ด ุชุฑุชูุจ ุตูุงูู ุงูุนุดุงุก (ุงูุณุนุฑ ุงูุฃุณุงุณู ${PRICES.service3Base} ุฑ.ุณ ูู 7 ููุงุฏุฑ)</legend>
                        <ul style="font-size: 0.9em; color: #555; text-align: right; margin-top: 5px;">
                            <li>ุชุดูู ุงูุฎุฏูุฉ: 7 ููุงุฏุฑ ูุชุฑุชูุจ ูุชูุฏูู ุงูุตูุงูู ุญุณุจ ุงูุฏูุนุงุช ุงููุทููุจุฉ.</li>
                        </ul>
                        
                        <div style="border-top: 1px dashed #ccc; padding-top: 10px;">
                            <label style="font-weight: bold;">ูู ุฏูุนุฉ (ุนุฏุฏ ุงููุฑุงุช)ุ</label>
                            <input type="number" id="numTrays3" min="1" value="1" onchange="calculateTotal()"><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">ูู ุตูููุฉ ูุฏููุ</label>
                            <input type="number" id="numPlates3" min="1" value="1" onchange="calculateTotal()"><br>

                            <label style="font-weight: bold; margin-top: 10px;">ูุชู ุชุฑูุฏูุง ุฃู ูุจุฏุฃ (ููุช ุงููุชุญ)ุ</label>
                            <input type="time" id="startTime3" onchange="calculateTotal()"><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">ูู ุงููุฏุฉ ุจูู ูู ุฏูุนุฉุ</label>
                            <input type="number" id="duration3" min="10" value="30" onchange="calculateTotal()">
                        </div>

                        <legend>โ ุฎูุงุฑุงุช ุฅุถุงููุฉ:</legend>
                        <div style="margin-top: 10px;">
                            <input type="checkbox" id="genderSplit3" onchange="calculateTotal()">
                            <label for="genderSplit3">ููุฌุฏ ูุณู ุฑุฌุงู ููุณุงุก ุ</label><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">ูู ุนุฏุฏ ุงููุฑุงุณู ููู ุตูููุฉุ</label>
                            <input type="number" id="numChairs3" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                            <span style="font-size: 0.9em;"> (ูุชูุธูู ุงููุงุนุฉ)</span><br>
                            
                            <label style="font-weight: bold; margin-top: 10px;">๐ฅ ุฅุถุงูุฉ ููุงุฏุฑ (+${PRICES.extraStaff} ุฑ.ุณ ูููุงุฏุฑ):</label>
                            <input type="number" id="extraStaff3" min="0" value="0" onchange="calculateTotal()" style="width: 50px; text-align: center;">
                        </div>
                    </fieldset>`;
            }

            additionalOptionsDiv.innerHTML = optionsHtml;
            calculateTotal();
        }

        // **********************************
        // 5. ูุธููุฉ ุญุณุงุจ ุงูุฅุฌูุงูู
        // **********************************
        function calculateTotal() {
            let currentTotal = 0;
            let details = [];

            // --- ุญุณุงุจ ุถูุงูุฉ ุฑูุดุณุชุง ---
            if (document.getElementById('service1').checked) {
                const selectedPackage = document.querySelector('input[name="pkg1"]:checked');
                let pkgPrice = 0;
                let pkgStaff = 0;

                if (selectedPackage) {
                    pkgPrice = parseFloat(selectedPackage.dataset.price);
                    pkgStaff = parseInt(selectedPackage.dataset.staff);
                    currentTotal += pkgPrice;
                    details.push(`ุงูุถูุงูุฉ: ${selectedPackage.value} (+${pkgStaff} ููุงุฏุฑ) - ุงูุณุนุฑ ุงูุฃุณุงุณู: ${pkgPrice} ุฑ.ุณ`);
                } else {
                    details.push("ุงูุถูุงูุฉ: ูู ูุชู ุงุฎุชูุงุฑ ุงูุจุงูุฉ ุงูุฃุณุงุณูุฉ. (ูุฌุจ ุงุฎุชูุงุฑ ุจุงูุฉ)");
                }

                const waterQty = parseInt(document.getElementById('extraWater1')?.value || 0);
                if (waterQty > 0) {
                    currentTotal += waterQty * PRICES.extraWater;
                    details.push(`+ ${waterQty} ูุฑุชูู ูุงุก ุฅุถุงูู (+${waterQty * PRICES.extraWater} ุฑ.ุณ)`);
                }
                const baklavaQty = parseInt(document.getElementById('extraBaklava1')?.value || 0);
                if (baklavaQty > 0) {
                    currentTotal += baklavaQty * PRICES.extraBaklava;
                    details.push(`+ ${baklavaQty} ูุฌููุนุฉ ุญูุง/ุจููุงูุฉ (+${baklavaQty * PRICES.extraBaklava} ุฑ.ุณ)`);
                }
                const datesQty = parseInt(document.getElementById('extraDatesSweet1')?.value || 0);
                if (datesQty > 0) {
                    currentTotal += datesQty * PRICES.extraDatesSweet;
                    details.push(`+ ${datesQty} ูุฌููุนุฉ ุญูู ุงูุชูุฑ (+${datesQty * PRICES.extraDatesSweet} ุฑ.ุณ)`);
                }
                const extraStaffQty = parseInt(document.getElementById('extraStaff1')?.value || 0);
                if (extraStaffQty > 0) {
                    currentTotal += extraStaffQty * PRICES.extraStaff;
                    details.push(`+ ${extraStaffQty} ูุงุฏุฑ ุถูุงูุฉ ุฅุถุงูู (+${extraStaffQty * PRICES.extraStaff} ุฑ.ุณ)`);
                }
            }
            
            // --- ุญุณุงุจ ุจูููู ุฑูุดุณุชุง ---
            if (document.getElementById('service2').checked) {
                currentTotal += PRICES.service2Base;
                details.push(`ุงูุจูููู: ุงูุณุนุฑ ุงูุฃุณุงุณู (300 ุดุฎุต) ${PRICES.service2Base} ุฑ.ุณ`);

                const extraGuestsQty = parseInt(document.getElementById('extraGuests2')?.value || 0);
                if (extraGuestsQty > 0) {
                    currentTotal += extraGuestsQty * PRICES.extraBuffet100;
                    details.push(`+ ${extraGuestsQty * 100} ุดุฎุต ุฅุถุงูู (ูุถุงุนู 100) (+${extraGuestsQty * PRICES.extraBuffet100} ุฑ.ุณ)`);
                }
                const waterQty = parseInt(document.getElementById('extraWater2')?.value || 0);
                if (waterQty > 0) {
                    currentTotal += waterQty * PRICES.extraWater;
                    details.push(`+ ${waterQty} ูุฑุชูู ูุงุก ุฅุถุงูู (+${waterQty * PRICES.extraWater} ุฑ.ุณ)`);
                }
                
                const fruitQty = parseInt(document.getElementById('extraFruit2')?.value || 0);
                if (fruitQty > 0) {
                    currentTotal += fruitQty * PRICES.extraFruit;
                    details.push(`+ ${fruitQty} ุณูุฉ ููุงูู ุทุงุฒุฌุฉ (+${fruitQty * PRICES.extraFruit} ุฑ.ุณ)`);
                }

                const extraStaffQty = parseInt(document.getElementById('extraStaff2')?.value || 0);
                if (extraStaffQty > 0) {
                    currentTotal += extraStaffQty * PRICES.extraStaff;
                    details.push(`+ ${extraStaffQty} ูุงุฏุฑ ุจูููู ุฅุถุงูู (+${extraStaffQty * PRICES.extraStaff} ุฑ.ุณ)`);
                }
            }
            
            // --- ุญุณุงุจ ุชุฑุชูุจ ุตูุงูู ุงูุนุดุงุก ---
            if (document.getElementById('service3').checked) {
                currentTotal += PRICES.service3Base;
                details.push(`ุชุฑุชูุจ ุงูุตูุงูู: ุงูุณุนุฑ ุงูุฃุณุงุณู (7 ููุงุฏุฑ) ${PRICES.service3Base} ุฑ.ุณ`);
                
                const extraStaffQty = parseInt(document.getElementById('extraStaff3')?.value || 0);
                if (extraStaffQty > 0) {
                    currentTotal += extraStaffQty * PRICES.extraStaff;
                    details.push(`+ ${extraStaffQty} ูุงุฏุฑ ุตูุงูู ุฅุถุงูู (+${extraStaffQty * PRICES.extraStaff} ุฑ.ุณ)`);
                }
                
                details.push(`*ุฏูุนุฉ ุงูุตูุงูู:* ${document.getElementById('numTrays3')?.value || 'ุบูุฑ ูุญุฏุฏ'}`);
                details.push(`*ุนุฏุฏ ุงูุตูุงูู:* ${document.getElementById('numPlates3')?.value || 'ุบูุฑ ูุญุฏุฏ'}`);
                details.push(`*ุจุฏุงูุฉ ุงูุฎุฏูุฉ:* ${document.getElementById('startTime3')?.value || 'ุบูุฑ ูุญุฏุฏ'}`);
                details.push(`*ุงููุฏุฉ ุจูู ุงูุฏูุนุงุช:* ${document.getElementById('duration3')?.value || 'ุบูุฑ ูุญุฏุฏ'} ุฏูููุฉ`);
                details.push(`*ุงููุตุงู ุฑุฌุงู/ูุณุงุก:* ${document.getElementById('genderSplit3')?.checked ? 'ูุนู' : 'ูุง'}`);
                details.push(`*ุนุฏุฏ ุงููุฑุงุณู:* ${document.getElementById('numChairs3')?.value || 'ุบูุฑ ูุญุฏุฏ'}`);
            }

            totalElement.textContent = currentTotal.toLocaleString();
            return { total: currentTotal, details: details };
        }

        // **********************************
        // 6. ูุธููุฉ ุชุฌููุฒ ุงูุจูุงูุงุช ููู Webhook
        // **********************************
        function collectDataForWebhook() {
            const calculatedData = calculateTotal();
            const selectedServices = [];
            if (document.getElementById('service1').checked) selectedServices.push(document.getElementById('service1').value);
            if (document.getElementById('service2').checked) selectedServices.push(document.getElementById('service2').value);
            if (document.getElementById('service3').checked) selectedServices.push(document.getElementById('service3').value);
            
            const selectedPackageElement = document.querySelector('input[name="pkg1"]:checked');
            const selectedPackageName = selectedPackageElement ? selectedPackageElement.value : 'ูู ูุชู ุงูุงุฎุชูุงุฑ';

            return {
                // ุงูุญููู ุงูุฃุณุงุณูุฉ
                clientName: document.getElementById('clientName').value,
                adminEmail: document.getElementById('emailInput').value,
                eventDate: document.getElementById('eventDate').value,
                eventType: document.getElementById('eventType').value,
                eventLocation: document.getElementById('eventLocation').value,
                
                // ุชูุงุตูู ุงูุญุณุงุจ ูุงูุฅุฌูุงูู
                totalPrice: calculatedData.total,
                finalPriceText: totalElement.textContent + ' ุฑ.ุณ',
                mapLink: getMapLink(),
                selectedServices: selectedServices.join(', '),
                
                // ุชูุงุตูู ุงูุฎุฏูุงุช ุงูุฅุถุงููุฉ ูู ุณุทุฑ ูุงุญุฏ ูุชุฎุฒูููุง ูู ุญูู ูุตู ูุจูุฑ ูู Notion
                detailedBreakdown: calculatedData.details.join('\n- ')
            };
        }

        // **********************************
        // 7. ูุธููุฉ ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Make.com (Notion) - ุตุงูุชุฉ
        // **********************************
        async function sendToNotion(data) {
            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    console.error('Webhook failed to execute. Status:', response.status);
                    // ูู ุญุงูุฉ ูุดู ุงูุฅุฑุณุงูุ ููููู ุฅุฑุณุงู ุชูุจูู ูู (ูููุณ ููุนููู)
                } else {
                    console.log('Data successfully sent to Notion via Make.com webhook.');
                }
            } catch (error) {
                console.error('Error sending data to Webhook:', error);
                // ุงูุชุนุงูู ูุน ุฃุฎุทุงุก ุงูุดุจูุฉ
            }
        }


        // **********************************
        // 8. ูุธููุฉ ุฅุฑุณุงู ุงููุงุชุณุงุจ ูููุทู ุงูุชุณููู ุงููุชูุงุทุน (ุงูููุงุฆูุฉ)
        // **********************************
        async function confirmBooking() {
            const clientName = document.getElementById('clientName').value;
            const eventDate = document.getElementById('eventDate').value;
            const eventType = document.getElementById('eventType').value;
            const eventLocation = document.getElementById('eventLocation').value;
            const emailInput = document.getElementById('emailInput').value;

            // ุงูุชุญูู ูู ุงูุญููู ุงูุฃุณุงุณูุฉ
            if (!clientName || !eventDate || !eventType || !eventLocation || !emailInput) {
                alert('ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุฌููุน ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ุฃููุงู.');
                return;
            }
            
            const isService1Checked = document.getElementById('service1').checked;
            if (isService1Checked && !document.querySelector('input[name="pkg1"]:checked')) {
                 alert('ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุจุงูุฉ ุงูุถูุงูุฉ (ุงูุนุงุฏูุฉุ ุงููุชูุณุทุฉุ ุฃู ุงููุฎูุฉ) ูุงุณุชููุงู ุงูุญุฌุฒ.');
                 return;
            }

            // --- ุงูููุทู ุงูุชุณูููู (Cross-selling) ---
            // (ููุณ ููุทู ุงูุญูู ุงูุณุงุจูุ ูุจูู ููุง ูู)
            // ... (ุจููุฉ ููุฏ ุงูุชุณููู ุงููุชูุงุทุน) ...

            const bookingData = collectDataForWebhook();
            
            // ๐ ุงูุฎุทูุฉ ุงูุฃุณุทูุฑูุฉ: ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Notion ุจุตูุช
            await sendToNotion(bookingData); 
            
            // ----------------------------------------------------

            // ุจูุงุก ุฑุณุงูุฉ ุงููุงุชุณุงุจ ุงูุฃุณุทูุฑูุฉ (ุงููุตููุฉ ููุชูุจูู ูู ููุท)
            let whatsappMessage = `*๐ ุทูุจ ุญุฌุฒ ุฌุฏูุฏ ุจุงูุชุธุงุฑู ูู Notion! ๐*\n\n`;
            whatsappMessage += `*ุงูุนููู:* ${bookingData.clientName}\n`;
            whatsappMessage += `*ุงูุชุงุฑูุฎ:* ${bookingData.eventDate}\n`;
            whatsappMessage += `*ุงูุฅุฌูุงูู ุงูุชูุฏูุฑู:* ${bookingData.finalPriceText}\n\n`;
            
            if (bookingData.mapLink) {
                whatsappMessage += `*๐ ุฑุงุจุท ุงููููุน:* ${bookingData.mapLink}\n\n`;
            }
            
            whatsappMessage += `ุชู ุชุณุฌูู ุงูุทูุจ ูู ูุงุนุฏุฉ ุจูุงูุงุชู. ุงูุฑุฌุงุก ูุฑุงุฌุนุฉ Notion ููููุงููุฉ ุนูู ุงูุญุฌุฒ ุฃู ุฑูุถู.\n\n*ูุชููู ููู ูููุงู ุณุนูุฏุงู.*`;

            // ุงูุชูุฌูู ุฅูู ุงููุงุชุณุงุจ (ูุฑูู ุงูุญุฌุฒ)
            const whatsappNumber = '966544512811';
            const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;
            
            // ุฑุณุงูุฉ ุงูุชูุจูู ุงูููุงุฆูุฉ ููุนููู (ุฃุตุจุญ ุงูุฃูุฑ ุฃูุซุฑ ุฑุณููุฉ)
            alert(`ุดูุฑุงู ูู ูุง ${clientName}!\n\nุชู ุงุณุชูุงู ุทูุจู (ุงูุฅุฌูุงูู ุงูุชูุฏูุฑู: ${bookingData.finalPriceText}).\n\nุณูุชู ุชุญูููู ุฅูู ุงููุงุชุณุงุจ ุงูุขู ูุฅุชูุงู ุงููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ ูุงูุชุฃููุฏ ูู ูุจู ูุฑูููุง.`);
            window.open(whatsappURL, '_blank');
            closeBookingModal();
        }

        function checkDateAvailability() {
            const dateInput = document.getElementById('eventDate').value;
            const statusElement = document.getElementById('availabilityStatus');
            const clientName = document.getElementById('clientName').value;

            if (!dateInput || !clientName) {
                statusElement.textContent = "ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุงูุงุณู ูุงูุชุงุฑูุฎ ุฃููุงู.";
                statusElement.style.color = 'red';
                return;
            }

            // ************* ูุญุงูุงุฉ ุงูุชุญูู ูู ุงูุชูุงูุฑ *************
            statusElement.textContent = "ุฌุงุฑู ุงูุชุญูู ูู ุชูุงูุฑ ุงูุชุงุฑูุฎ ูู ุชุญุฏูุซ ุงููุธุงู ุงูุฏุงุฎูู...";
            statusElement.style.color = '#ff9900';
            
            // ูุญุงูุงุฉ ุชุฃุฎูุฑ ุงูุดุจูุฉ
            setTimeout(() => {
                // ูุซุงู: ุฅุฐุง ูุงู ุงูุชุงุฑูุฎ 2026-01-01ุ ููุชุฑุถ ุฃูู ูุญุฌูุฒ (ูุบุฑุถ ุงููุญุงูุงุฉ)
                if (dateInput === '2026-01-01') {
                    statusElement.textContent = "โ ุงูุชุงุฑูุฎ ุบูุฑ ูุชุงุญ! (ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุชุงุฑูุฎ ุขุฎุฑ)";
                    statusElement.style.color = 'red';
                } else {
                    statusElement.textContent = "โ ุงูุชุงุฑูุฎ ูุชุงุญ ูุจุฏุฆูุงู.";
                    statusElement.style.color = 'green';
                }
            }, 1000);
            // **************************************************
        }

        document.addEventListener('DOMContentLoaded', () => {
            const formElements = document.getElementById('bookingForm').elements;
            for (let i = 0; i < formElements.length; i++) {
                formElements[i].addEventListener('change', updateBookingOptions);
                formElements[i].addEventListener('input', updateBookingOptions);
            }
            updateBookingOptions();
        });
    </script>
